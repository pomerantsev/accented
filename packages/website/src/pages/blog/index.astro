---
import { getCollection } from 'astro:content';
import RSS from '~/components/icons/RSS.astro';
import MainLayout from '~/layouts/MainLayout.astro';
import { formatPostDate, getPostDate, getPostUrl } from '~/pages/blog/helpers';

const posts = await getCollection('blog');
---
<style>
  nav {
    margin-block: var(--space-l);
  }

  ol {
    padding-inline-start: 0;
  }

  :is(nav, h2) a {
    text-decoration-line: none;
  }

  nav a {
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: var(--space-3xs);
  }

  @media (hover: hover) {
    :is(nav, h2) a:hover {
      color: var(--color-primary);
    }
  }
</style>
<MainLayout>
  <h1>Blog</h1>
  <nav aria-label="Blog">
    <a href="/blog/rss.xml"><span class="icon"><RSS /></span> RSS</a>
  </nav>
  <ol role="list">
    {
      posts.map((post) => (
        <li class="flow">
          <h2>
            <a href={getPostUrl(post)}>{post.data.title}</a>
          </h2>
          <div><time datetime={getPostDate(post)}>{formatPostDate(post)}</time></div>
          <p>{post.data.description}</p>
        </li>
      ))
    }
  </ol>
</MainLayout>
